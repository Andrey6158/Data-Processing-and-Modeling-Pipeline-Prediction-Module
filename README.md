# Data Processing and Modeling Pipeline

## Описание проекта

Этот проект представляет собой конвейер для обработки данных, обучения модели машинного обучения (CatBoostRegressor) и прогнозирования значения целевой переменной. Он включает в себя четыре основных компонента: предобработку данных, отбор признаков, обучение модели и выполнение прогноза.

## Компоненты

### 1. Clean
Класс `Clean` отвечает за предварительную обработку набора данных. Включает следующие этапы:
- Удаление дубликатов.
- Удаление пропущенных значений.
- Разделение признаков по типу данных.
- Удаление выбросов.
- Удаление признаков с высокой взаимной корреляцией. При этом из двух признаков с высокой взаимной корреляцией удаляется тот, у которого корреляция с зависимой переменной ниже.
- Разделение набора данных на обучающую, тестовую и валидационную выборки.

### 2. FeaturesSelection
Класс `FeaturesSelection` используется для отбора признаков на основе:
- Индекса стабильности популяции (PSI). Если распределение соответствующих признаков в  обучающей, тестовой и валидационной выборках отличается по фактору PSI более чем на 20% (0.2), то эти признаки удаляются.
- Важности признаков с использованием метода SHAP. Признаки, важность которых по критерию SHAP составляет менее 1% (0.01)от максимальной важности какого либо признака, отсеиваются.


### 3. TrainingHyperparameterSelectionning
Класс `TrainingHyperparameterSelection` предназначен для:
- Обучения модели CatBoostRegressor на тренировочной выборке.
- Оценки метрик модели по тренировочной, валидационной и тестовой выборкам.
- Подбора гиперпараметров по сетке по валидационной выбрке с задаваемой кросс-валидацией (cv=3). Сетка поиска гиперпараметров предустановлена, но также может быть и задана пользователем (эта часть кода закоментирована и оставлена как опция). 
- Оценки метрик модели с лучшими гиперпараметрами по тренировочной, валидационной и тестовой выборкам.
- Сохранения лучшей модели и набора признаков.


#### Вышеперечисленные классы объединены в дочерний класс `Pipeline`.


### 4. Predict
Класс `Predict` выполняет следующее:
- Принимает на вход датасет, для которого необходимо предсказать значения целевой переменной.
- Принимает на вход предварительно обученную модель.
- Принимает на вход набор отобранных признаков.
- На основе этих данных выполняет прогнозирование целевой переменной.
- Добавляет в исходный датасет предсказанные значения, доверительный интервал прогноза (±20% от предсказанного значения) и метку, указывающую, попадает ли истинное значение целевой переменной в этот интервал.
- Возвращает обновленный датасет с добавленными данными.


## Использование

Для использования этого конвейера, создайте экземпляр класса `Pipeline`, передав необходимые параметры, такие как путь к данным (обязательный параметр), имя целевого признака (обязательный параметр), список признаков, подлежащих удалению (обязательный параметр). Затем последовательно вызовите методы `clean`, `features_selection` и `training_hyperparameter_selection` для выполнения соответствующих этапов обработки и обучения модели. После этого создайте экземпляр класса `Predict`, передав необходимые параметры и вызовите метод `predict`. Информация о статусе выполнения задач записывается в текстовые файлы. Информация о важности признаков записывается в файл c hfcibhtybtv `png`. Обновленный датасет возвращается в директорию Проекта.
