# Data Processing and Modeling Pipeline

## Описание проекта

Этот проект представляет собой конвейер для обработки данных и обучения моделей машинного обучения. Он включает в себя три основных компонента: предобработку данных, отбор признаков и обучение модели с подбором гиперпараметров.

## Компоненты

### 1. Clean
Класс `Clean` отвечает за предварительную обработку набора данных. Включает следующие этапы:
- Удаление дубликатов.
- Разделение признаков по типу данных.
- Кодирование категориальных (не числовых и не булевых) признаков c помощью методов Target encoding или One-hot encoding (по выбору).
- Удаление признаков с высокой взаимной корреляцией. При этом из двух признаков с высокой взаимной корреляцией удаляется тот, у которого корреляция с зависимой переменной ниже.
- Обработка пропущенных значений методом K-ближайших соседей.
- Разделение набора данных на обучающую, тестовую и валидационную выборки.

### 2. Features
Класс `Features` используется для выбора признаков на основе:
- Индекса стабильности популяции (PSI). Если распределение соответствующих признаков в  обучающей, тестовой и валидационной выборках отличается по фактору PSI более чем на 20% (0.2), то эти признаки удаляются.
- Важности признаков с использованием метода SHAP. Признаки, важность которых по критерию SHAP составляет менее 1% (0.01)от максимальной важности какого либо признака, отсеиваются.


### 3. Training
Класс `Training` предназначен для:
- Обучения модели LGBMClassifier на тренировочной выборке.
- Оценки метрик модели по тренировочной, валидационной и тестовой выборкам.
- Подбора гиперпараметров по сетке по валидационной выбрке с задаваемой кросс-валидацией (cv=3). Сетка поиска гиперпараметров предустановлена, но также может быть и задана пользователем. 
- Оценки метрик модели с лучшими гиперпараметрами по тренировочной, валидационной и тестовой выборкам.
- Сохранения лучшей модели и набора признаков.


## Использование

Для использования этого конвейера, создайте экземпляр класса `Pipeline`, передав необходимые параметры, такие как путь к данным (обязательный параметр), имя целевого признака (обязательный параметр), метод кодирования (не обязательный параметр). Затем последовательно вызовите методы `clean`, `features` и `training` для выполнения соответствующих этапов обработки и обучения модели.
